<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>焦点切换</title>
    <style type="text/css">
	    * {
	    	margin: 0;
	    	padding: 0;
	    	list-style-type:none;
	    }
		a, img {
			border: 0;
		}
		body {
			font:12px/180% Arial, Helvetica, sans-serif, "新宋体";
		}
		.out {
			background: #106B94;
			text-align: center;
		}
		.focus {
			background: #106B94 !important;
		}
		.h {
			height: 300px;
		}
		svg {
			cursor: pointer;
		}
		.progress {
			stroke-dashoffset: 282.783px;
			animation: progressAnimation 3000ms linear infinite;
		}
		/*path:nth-child(2) {
			stroke-dashoffset: 282.783px;
			animation: progressAnimation 3000ms linear infinite;
		}*/
		@keyframes progressAnimation {
			from {
				stroke-dashoffset: 282.783px;
			}
			to {
				stroke-dashoffset: 6px;
			}
		}
		.progress-active {
			stroke-dashoffset: 6px !important;
		}
    </style>
    <link rel="stylesheet" href="css/wy-mod-banner.css" media="screen">    	
</head>
<body>
<div class="wy-mod-banner" style="overflow:hidden; background: rgb(36, 40, 44);">

	<div id="_banners" class="banners">
		<div class="banner banner4">
			<img width="1600" height="680" src="images/banner4.jpg" alt="微云，生活精彩" />
		</div>
		<div class="banner banner3">
			<img width="1600" height="680" src="images/banner3.jpg" alt="微云，生活精彩" />
		</div>
		<div class="banner banner2">
			<img width="1600" height="680" src="images/banner2.jpg" alt="微云，生活精彩" />
		</div>
		<div class="banner banner1">
			<img width="1600" height="680" src="images/banner1.jpg" alt="微云，生活精彩" />
		</div>
	</div>
	<div id="_focus" class="focus">
		<a data-index="0" href="javascript:void(0);">
			<svg viewBox="0 0 100 100" style="width: 13px; margin-top: 1.5px;">
				<path d="M 50,50 m 0,-45 a 45,45 0 1 1 0,90 a 45,45 0 1 1 0,-90"
					  stroke="rgba(255,255,255,0.2)"
					  stroke-width="10"
					  fill-opacity="0">
				</path>
				<path	class="progress"
						 d="M 50,50 m 0,-45 a 45,45 0 1 1 0,90 a 45,45 0 1 1 0,-90"
						 stroke="#fff"
						 stroke-width="10"
						 fill-opacity="0"
						 style="stroke-dasharray: 282.783, 282.783; stroke-dashoffset: 282.783;"
						 data-spm-anchor-id="5176.8142029.759393.i2.a7236d3ebbz3rU">
				</path>
			</svg>
		</a>
		<a data-index="1" href="javascript:void(0);">
			<svg viewBox="0 0 100 100" style="width: 13px; margin-top: 1.5px;">
				<path d="M 50,50 m 0,-45 a 45,45 0 1 1 0,90 a 45,45 0 1 1 0,-90"
					  stroke="rgba(255,255,255,0.2)"
					  stroke-width="10"
					  fill-opacity="0">
				</path>
				<path
						d="M 50,50 m 0,-45 a 45,45 0 1 1 0,90 a 45,45 0 1 1 0,-90"
						stroke="#fff"
						stroke-width="10"
						fill-opacity="0"
						style="stroke-dasharray: 282.783, 282.783; stroke-dashoffset: 282.783;"
						data-spm-anchor-id="5176.8142029.759393.i2.a7236d3ebbz3rU">
				</path>
			</svg>
		</a>
		<a data-index="2" href="javascript:void(0);">
			<svg viewBox="0 0 100 100" style="width: 13px; margin-top: 1.5px;">
				<path d="M 50,50 m 0,-45 a 45,45 0 1 1 0,90 a 45,45 0 1 1 0,-90"
					  stroke="rgba(255,255,255,0.2)"
					  stroke-width="10"
					  fill-opacity="0">
				</path>
				<path
						d="M 50,50 m 0,-45 a 45,45 0 1 1 0,90 a 45,45 0 1 1 0,-90"
						stroke="#fff"
						stroke-width="10"
						fill-opacity="0"
						style="stroke-dasharray: 282.783, 282.783; stroke-dashoffset: 282.783;"
						data-spm-anchor-id="5176.8142029.759393.i2.a7236d3ebbz3rU">
				</path>
			</svg>
		</a>
		<a data-index="3" href="javascript:void(0);">
			<svg viewBox="0 0 100 100" style="width: 13px; margin-top: 1.5px;">
				<path d="M 50,50 m 0,-45 a 45,45 0 1 1 0,90 a 45,45 0 1 1 0,-90"
					  stroke="rgba(255,255,255,0.2)"
					  stroke-width="10"
					  fill-opacity="0">
				</path>
				<path
						d="M 50,50 m 0,-45 a 45,45 0 1 1 0,90 a 45,45 0 1 1 0,-90"
						stroke="#fff"
						stroke-width="10"
						fill-opacity="0"
						style="stroke-dasharray: 282.783, 282.783; stroke-dashoffset: 282.783;"
						data-spm-anchor-id="5176.8142029.759393.i2.a7236d3ebbz3rU">
				</path>
			</svg>
		</a>

	</div>

</div>
<script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
<script type="text/javascript">
// var pathLis = $('path:nth-child(2)');
// console.log(pathLis);
// pathLis.eq(0).addClass('progress');
// console.log(pathLis.eq(0));
// pathLis.eq(1).addClass('progress');

// var oDiv = $('.out');
// oDiv.addClass('h');

// var pathLis = $('path:nth-child(2)');
// console.log(pathLis);
// pathLis.eq(0).attr('class', 'progress');

var glume = function (banners_id, focus_id) {
	this.$ctn = $('#' + banners_id);
    this.$focus = $('#' + focus_id);
	this.$btns = null;
	this.switchSpeed = 3; // 自动播放间隔(s)
	this.defOpacity = 1;
	this.crtIndex = 0;
	this.adLength = 0;
    this.timerSwitch = null;
	this.init();
};
glume.prototype = {
	fnNextIndex: function() {
		return (this.crtIndex >= this.adLength - 1) ? 0 : this.crtIndex + 1;
	},
	// 动画切换
    fnSwitch: function (toIndex) {
        if (this.crtIndex == toIndex) { return; }
        this.$adLis.css('zIndex', 0);
        this.$adLis.filter(':eq('+this.crtIndex+')').css('zIndex', 2);
        this.$adLis.filter(':eq('+toIndex+')').css('zIndex', 1);
        this.$btns.removeAttr('class');
        this.$btns.filter(':eq('+toIndex+')').attr('class', 'progress');
        var me = this;

        $(this.$adLis[this.crtIndex]).animate({
            opacity: 0
        }, 1000, function() {
            me.crtIndex = toIndex;
            $(this).css({
                opacity: me.defOpacity,
                zIndex: 0
            });
        });
    },
    fnAutoPlay: function(){
        this.fnSwitch(this.fnNextIndex());
    },
    fnPlay: function(){
        var me = this;
        me.timerSwitch = window.setInterval(function() {
            me.fnAutoPlay();
        }, me.switchSpeed * 1000);
    },
    fnStopPlay: function(){
        window.clearTimeout(this.timerSwitch);
        this.timerSwitch = null;
    },
	init: function() {
		this.$adLis = this.$ctn.children();
		this.$btns = $('path:nth-child(2)');
		this.adLength = this.$adLis.length;

        var me = this;
        //点击切换
        this.$focus.on('click', 'a', function(e) {
            e.preventDefault();
            console.log('点击');
            var index = parseInt($(this).attr('data-index'), 10);
            me.fnSwitch(index);
            me.fnStopPlay();
            me.$btns.removeAttr('class');
            me.$btns.filter(':eq('+index+')').attr('class', 'progress-active');
        });
        this.$adLis.filter(':eq('+ this.crtIndex +')').css('zIndex', 2);
        this.fnPlay();
	}
};
var player1 = new glume('_banners', '_focus');
</script>
</body>
</html>
